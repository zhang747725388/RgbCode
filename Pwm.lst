C51 COMPILER V9.01   PWM                                                                   04/27/2016 23:53:58 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE PWM
OBJECT MODULE PLACED IN Pwm.obj
COMPILER INVOKED BY: C:\keil51\C51\BIN\C51.EXE BSP\Pwm.c BROWSE INCDIR(.\APP;.\BSP;..\..\CodeGroup;..\rgbcode) DEBUG OBJ
                    -ECTEXTEND PRINT(.\Pwm.lst) OBJECT(Pwm.obj)

line level    source

   1           
   2          
   3          /*************  功能说明        **************
   4          
   5          ******************************************/
   6           
   7          #include "rsystem.h"
   8           /**************** 计算PWM重装值函数 *******************/
   9          u16     PWM_high,PWM_low;       //中间变量 
  10          
  11          u16     PWM_high1,PWM_low1;     //中间变量 
  12          void    LoadPWM(u16 i)
  13          {
  14   1              u16     j;
  15   1      
  16   1              if(i > PWM_HIGH_MAX)            i = PWM_HIGH_MAX;       //如果写入大于最大占空比数据，则强制为最大占空比。
  17   1              if(i < PWM_HIGH_MIN)            i = PWM_HIGH_MIN;       //如果写入小于最小占空比数据，则强制为最小占空比。
  18   1              j = 65536UL - PWM_DUTY + i;     //计算PWM低电平时间
  19   1              i = 65536UL - i;                        //计算PWM高电平时间
  20   1              EA = 0;
  21   1              PWM_high = i;   //装载PWM高电平时间
  22   1              PWM_low  = j;   //装载PWM低电平时间
  23   1              EA = 1;
  24   1      }
  25           
  26          void    LoadPWM1(u16 i)
  27          {
  28   1              u16     j;
  29   1      
  30   1              if(i > PWM_HIGH_MAX1)           i = PWM_HIGH_MAX1;      //如果写入大于最大占空比数据，则强制为最大占空比。
  31   1              if(i < PWM_HIGH_MIN1)           i = PWM_HIGH_MIN1;      //如果写入小于最小占空比数据，则强制为最小占空比。
  32   1              j = 65536UL - PWM_DUTY1 + i;    //计算PWM低电平时间
  33   1              i = 65536UL - i;                        //计算PWM高电平时间
  34   1              EA = 0;
  35   1              PWM_high1 = i;  //装载PWM高电平时间
  36   1              PWM_low1  = j;  //装载PWM低电平时间
  37   1              EA = 1;
  38   1      }
  39          void SetPwmMode123(){
  40   1        switch(modelflag){
  41   2        case 0:       LoadPWM(0);break;
  42   2        case 1:       LoadPWM(7448);break;
  43   2        case 2:       LoadPWM(7448);break;
  44   2        case 3:       LoadPWM(3723);break;
  45   2        case 4:       LoadPWM(3590);break;
  46   2        case 5:       LoadPWM(3590);break;
  47   2        case 6:       LoadPWM(3590);break;
  48   2        case 7:       LoadPWM(200);break;
  49   2        case 8:       LoadPWM(2610);break;
  50   2        
  51   2        }
  52   1          
  53   1      }
  54           
C51 COMPILER V9.01   PWM                                                                   04/27/2016 23:53:58 PAGE 2   

  55          void SetNomalHighPwm(){
  56   1                 SetPwmMode123();
  57   1                LoadPWM1(PWM_DUTY1/2);
  58   1      }
  59          
  60          
  61           


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    200    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
